import unittest

from frontends.gamespy.protocols.server_browser.v2.aggregations.encryption import EnctypeX


class EncryptionTest(unittest.TestCase):
    def test_enctypex(self):
        """
        test if enctypex param init correctness 
        """
        enc = EnctypeX("000000", "00000000")
        self.assertTrue(enc._enc_params.index_0.value == 250)
        self.assertTrue(enc._enc_params.index_1.value == 220)
        self.assertTrue(enc._enc_params.index_2.value == 245)
        self.assertTrue(enc._enc_params.index_3.value == 229)
        self.assertTrue(enc._enc_params.index_4.value == 49)
        register = b"\x7A\xFA\x64\xDC\xB9\xF5\xF6\xE5\x89\x84\x9D\x66\xD7\xEA\x8E\xD8\xD4\xC0\xA1\xA4\x67\xA9\xAA\xDF\xF0\x71\x99\xEC\x87\xFD\xD0\xA2\xF3\xB5\xE3\x01\xE7\x7D\xE9\xE2\xEB\x97\xF1\x6F\x70\xFC\xD6\xFB\x82\x95\xC1\xB1\xD9\xBF\xD1\xE0\x9E\x81\xE8\xBB\xE1\xF8\xAD\xDA\xDB\xE4\x65\xAE\xCE\xAB\xB4\xBD\xA5\xB6\xB8\xEE\xF4\x75\xBC\xC3\xC6\xB7\xC8\xC9\xBA\xA6\xC4\xC5\x85\x6B\x78\x6D\xC2\xA7\xCC\xCD\x62\x9F\xBE\xA8\xCB\xB0\xE6\xDD\x79\xA3\xCA\xF2\xCF\xAC\x6A\xEF\xFE\xED\xD5\xB2\xDE\xB3\x72\xF7\x6C\xF9\xC7\x39\xA0\xAF\x77\x35\x73\x74\x68\x76\x8A\x80\x6E\x63\x7B\x7C\x7F\x98\x9B\x88\x91\x94\x83\x93\x8D\x86\x9C\x9A\x7E\x92\x8B\x8C\xD2\x96\x8F\x90\xFF\x41\x32\x33\x34\x3D\x36\x37\x38\x49\x3A\x3B\x3C\x45\x3E\x3F\x40\x51\x42\x43\x44\x4D\x46\x47\x48\x59\x4A\x4B\x4C\x55\x4E\x4F\x50\x61\x52\x53\x54\x5D\x56\x57\x58\x69\x5A\x5B\x5C\xD3\x5E\x5F\x60\x00\x09\x02\x03\x04\x05\x06\x07\x08\x11\x0A\x0B\x0C\x0D\x0E\x0F\x10\x19\x12\x13\x14\x15\x16\x17\x18\x21\x1A\x1B\x1C\x1D\x1E\x1F\x20\x29\x22\x23\x24\x25\x26\x27\x28\x31\x2A\x2B\x2C\x2D\x2E\x2F\x30"
        temp_register = bytes([v.value for v in enc._enc_params.register])
        self.assertTrue(temp_register == register)
        pass
